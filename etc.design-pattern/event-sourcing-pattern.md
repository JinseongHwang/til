![img](https://learn.microsoft.com/ko-kr/azure/architecture/patterns/_images/event-sourcing-overview.png)

## 이벤트 소싱 패턴이란?

- 애플리케이션 상태에 대한 모든 변경 사항이 일련의 이벤트로 저장되도록 보장하는 아키텍처 패턴이다.
- CQRS 패턴을 활용한 Presentation 레이어 전달에 활용할 수 있다. (다른 방법으로 Materialized View 패턴도 있다.)

## 예시

장바구니에 다음과 같은 이벤트가 발생했다고 가정하자.
1. 아보카도 담기
2. 신라면 담기
3. 탄산수 담기
4. 탄산수 빼기

일반적으로 이벤트 소싱을 하지 않으면 현재 상태만 저장하므로 [아보카도, 신라면] 만 저장된 상태로 기록된다.  
이벤트 소싱 패턴으로 저장하면 [아보카도+, 신라면+, 탄산수+, 탄산수-] 와 같이 저장된다.  
결과는 똑같아 보이겠지만, 저장하는 방식과 형식이 다르다.  

## 특징

- 데이터의 현재 상태만 저장하는 것이 아니라, 상태 변경 시퀀스를 저장한다.
- 도메인 데이터의 상태가 변경될 때마다 새 이벤트가 시퀀스에 추가된다. 이미 쌓인 데이터는 변경될 수 없다.

## 장점

- 이벤트 시퀀스를 재생해서 언제든지 현재 애플리케이션 상태를 재구축할 수 있다.
- 감사 추적, 기록을 남기는 데 용이하다.
- 업데이트 충돌을 완전히 방지할 수 있다.

## 단점

- 현재 결과를 불러오는 데 시간이 오래 걸린다.
- 데이터가 많기 때문에 장기 저장 비용에 대해서도 고려해야 한다.

## 참고

- https://learn.microsoft.com/ko-kr/azure/architecture/patterns/event-sourcing